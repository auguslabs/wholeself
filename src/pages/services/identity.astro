---
/**
 * Identity/Transition Support Page
 */

import BaseLayout from '@/layouts/BaseLayout.astro';
import { getPageContent, getLocalizedText } from '@/data/services/contentService';
import { getLocaleFromPathname } from '@/utils/i18n';
import ConditionNavigation from '@/components/services/ConditionNavigation';
import ServicesCTA from '@/components/services/ServicesCTA';
import ConditionIcon from '@/components/services/ConditionIcon';
import ConditionBreadcrumb from '@/components/services/ConditionBreadcrumb';
import type { LocalizedText } from '@/data/models/ContentPage';

interface Condition {
  id: string;
  name: LocalizedText;
  description: LocalizedText;
  icon: string;
  link: string;
}

const lang = getLocaleFromPathname(Astro.url.pathname);
const servicesData = await getPageContent('services', lang);
const conditions = servicesData.content.conditionsSection?.conditions ?? [];
const currentCondition = conditions.find((c: Condition) => c.id === 'identity');
if (!currentCondition) return Astro.redirect(lang === 'es' ? '/es/services' : '/services');
const ctaSection = servicesData.content.ctaSection;
const pageTitle = `${getLocalizedText(currentCondition.name, lang)} - WholeSelf Counseling`;
---

<BaseLayout title={pageTitle}>
  <!-- Hero Section -->
  <section class="relative flex items-center justify-center min-h-[25vh] py-8 bg-blueGreen-300">
    <div class="container mx-auto max-w-4xl px-4 text-center">
      <div class="mb-3 inline-flex items-center justify-center w-12 h-12 rounded-full bg-white border-2 border-blueGreen-500">
        <div class="text-blueGreen-500">
          <ConditionIcon client:load iconName={getLocalizedText(currentCondition.icon, lang)} className="w-6 h-6" />
        </div>
      </div>
      <h1 class="text-2xl md:text-3xl font-bold text-white mb-2">
        {getLocalizedText(currentCondition.name, lang)}
      </h1>
      <p class="text-base text-white/90 max-w-2xl mx-auto">
        {getLocalizedText(currentCondition.description, lang)}
      </p>
    </div>
  </section>

  <!-- Breadcrumb Navigation -->
  <ConditionBreadcrumb
    client:load
    conditionName={currentCondition.name}
    language={lang}
  />

  <!-- Main Content -->
  <section class="py-12 px-4 bg-white">
    <div class="container mx-auto max-w-4xl">
      <!-- Introduction -->
      <div class="prose prose-lg max-w-none mb-12">
        <h2 class="text-2xl font-bold text-navy-900 mb-4">
          {lang === 'en' ? 'Understanding Identity and Transition' : 'Entendiendo la Identidad y la Transición'}
        </h2>
        <p class="text-gray-700 leading-relaxed mb-4">
          {lang === 'en' 
            ? 'Exploring and affirming your gender identity is a deeply personal journey. At WholeSelf Counseling, we provide affirming, supportive care for individuals navigating gender identity, transition, and authentic self-expression.'
            : 'Explorar y afirmar tu identidad de género es un viaje profundamente personal. En WholeSelf Counseling, brindamos atención afirmativa y de apoyo para personas que navegan la identidad de género, la transición y la expresión auténtica del ser.'}
        </p>
        <p class="text-gray-700 leading-relaxed">
          {lang === 'en'
            ? 'Our approach is grounded in respect, validation, and empowerment. We create a safe, non-judgmental space where you can explore your identity at your own pace. We support you through all aspects of your journey, from self-discovery to social transition, helping you build confidence and live authentically.'
            : 'Nuestro enfoque se basa en el respeto, la validación y el empoderamiento. Creamos un espacio seguro y sin juicios donde puedes explorar tu identidad a tu propio ritmo. Te apoyamos en todos los aspectos de tu viaje, desde el autodescubrimiento hasta la transición social, ayudándote a construir confianza y vivir auténticamente.'}
        </p>
      </div>

      <!-- Navigation between conditions -->
      <ConditionNavigation
        client:load
        conditions={conditions}
        currentConditionId="identity"
        language={lang}
      />

      <!-- CTA Section -->
      <ServicesCTA
        client:load
        title={ctaSection.title}
        subtitle={ctaSection.subtitle}
        primaryCTAs={ctaSection.primaryCTAs}
        secondaryCTA={ctaSection.secondaryCTA}
        language={lang}
      />
    </div>
  </section>
</BaseLayout>
